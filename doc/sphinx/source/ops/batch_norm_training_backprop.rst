.. batch_norm_training_backprop.rst:

#########################
BatchNormTrainingBackprop
#########################

.. code-block:: cpp

   BatchNormTrainingBackprop  // Compute mean and variance backprop from the input.


Description
===========



Inputs
------

+----------------------+-------------------------+------------------------------+
| Name                 | Element Type            | Shape                        |
+======================+=========================+==============================+
| ``input``            | real                    | :math:`(\bullet, C, \ldots)` |
+----------------------+-------------------------+------------------------------+
| ``gamma``            | same as ``input``       | :math:`(C)`                  |
+----------------------+-------------------------+------------------------------+
| ``beta``             | same as ``input``       | :math:`(C)`                  |
+----------------------+-------------------------+------------------------------+
| ``mean``             | same as ``input``       | :math:`(C)`                  |
+----------------------+-------------------------+------------------------------+
| ``variance``         | same as ``input``       | :math:`(C)`                  |
+----------------------+-------------------------+------------------------------+
| ``normalized_delta`` | same as ``input``       | :math:`input`                |
+----------------------+-------------------------+------------------------------+


Attributes
----------

+------------------+--------------------+--------------------------------------------------------+
| Name             | Type               | Notes                                                  |
+==================+====================+========================================================+
| ``epsilon``      | ``double``         | Small bias added to variance to avoid division by 0.   |
+------------------+--------------------+--------------------------------------------------------+

Outputs
-------

+---------------------+-------------------------+-----------------------------+
| Name                | Element Type            | Shape                       |
+=====================+=========================+=============================+
| ``input_delta``     | same as ``input``       | Same as ``input``           |
+---------------------+-------------------------+-----------------------------+
| ``gamma_delta``     | same as ``gamma``       | :math:`(C)`                 |
+---------------------+-------------------------+-----------------------------+
| ``beta_delta``      | same as ``beta``        | :math:`(C)`                 |
+---------------------+-------------------------+-----------------------------+


Mathematical Definition
=======================


C++ Interface
==============

.. doxygenclass:: ngraph::op::BatchNormTrainingBackprop
   :project: ngraph
   :members:


